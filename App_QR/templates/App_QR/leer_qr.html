{% extends 'App_QR/base.html' %}
{% load static %}
{% block title %}Leer CÃ³digo QR{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'App_QR/css/leer_qr.css' %}">
{% endblock %}
{% block content %}
<h2>ðŸ“· Escanear CÃ³digo QR</h2>
<p>Permite acceso a la cÃ¡mara para leer el QR del turno.</p>
<div id="reader"></div>
<div class="result-box hidden" id="result">
    <strong>Resultado:</strong>
    <code id="resultText"></code>
    <a id="goLink" class="btn btn-success" href="#" target="_blank">Ir a la URL</a>
</div>
<script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
<script>
const resultBox = document.getElementById('result');
const resultText = document.getElementById('resultText');
const goLink = document.getElementById('goLink');
function onScanSuccess(decodedText, decodedResult) {
  resultText.textContent = decodedText;
  goLink.href = decodedText;
  resultBox.classList.remove('hidden');
  if (decodedText.startsWith('http')) {
    window.location.href = decodedText;
  }
  html5QrcodeScanner.clear();
}
function onScanFailure(error) {}
let html5QrcodeScanner = new Html5QrcodeScanner(
    'reader', { fps: 10, qrbox: 250 }
);
html5QrcodeScanner.render(onScanSuccess, onScanFailure);
</script>
{% endblock %}
