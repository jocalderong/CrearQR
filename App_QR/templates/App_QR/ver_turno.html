{% extends 'App_QR/base.html' %}
{% load static %}

{% block title %}Turno {{ turno.codigo }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'App_QR/css/ver_turno.css' %}">
{% endblock %}

{% block content %}
<div class="turno-detalle">
    <div class="qr-container">
        <div class="turno-numero">TURNO {{ turno.codigo }}</div>
        <div class="estado-badge estado-{{ turno.estado }}">
            {{ turno.get_estado_display }}
        </div>
        
        <div class="qr-code">
            <img src="{{ qr_code }}" alt="CÃ³digo QR Turno {{ turno.codigo }}">
        </div>
        
        <p>Escanea este cÃ³digo QR para ver el estado del turno</p>
    </div>
    
    <div class="info-grid">
        <div class="info-item">
            <div class="info-label">ğŸ‘¤ Cliente</div>
            <div class="info-value">
                {% if turno.cliente %}
                    <a href="{% url 'cliente_detail' turno.cliente.pk %}">{{ turno.cliente.nombre }}</a>
                {% else %}
                    {{ turno.cliente_nombre }}
                {% endif %}
            </div>
        </div>
        
        {% if turno.cliente_email %}
        <div class="info-item">
            <div class="info-label">ğŸ“§ Email</div>
            <div class="info-value">{{ turno.cliente_email }}</div>
        </div>
        {% endif %}
        
        {% if turno.cliente_telefono %}
        <div class="info-item">
            <div class="info-label">ğŸ“± TelÃ©fono</div>
            <div class="info-value">{{ turno.cliente_telefono }}</div>
        </div>
        {% endif %}
        
        <div class="info-item">
            <div class="info-label">ğŸ”§ Servicio</div>
            <div class="info-value">{{ turno.servicio }}</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">ğŸ•’ Creado</div>
            <div class="info-value">{{ turno.fecha_creacion|date:"d/m/Y H:i" }}</div>
        </div>
        
        {% if turno.fecha_atencion %}
        <div class="info-item">
            <div class="info-label">â° AtenciÃ³n</div>
            <div class="info-value">{{ turno.fecha_atencion|date:"d/m/Y H:i" }}</div>
        </div>
        {% endif %}
    </div>
    
    {% if turno.observaciones %}
    <div class="info-item">
        <div class="info-label">ğŸ“ Observaciones</div>
        <div class="info-value">{{ turno.observaciones }}</div>
    </div>
    {% endif %}
    
    <div class="actions">
        <a href="{% url 'descargar_qr' turno.uuid %}" class="btn btn-success">Descargar QR</a>
        
        {% if turno.estado == 'pendiente' %}
        <a href="{% url 'cambiar_estado' turno.uuid 'en_atencion' %}" class="btn">Marcar en AtenciÃ³n</a>
        {% elif turno.estado == 'en_atencion' %}
        <a href="{% url 'cambiar_estado' turno.uuid 'atendido' %}" class="btn btn-success">Marcar como Atendido</a>
        {% endif %}
        
        {% if turno.estado != 'cancelado' and turno.estado != 'atendido' %}
        <a href="{% url 'cambiar_estado' turno.uuid 'cancelado' %}" class="btn btn-danger">Cancelar Turno</a>
        {% endif %}
        
        <a href="{% url 'home' %}" class="btn btn-secondary">Volver al Inicio</a>
    </div>
</div>
{% endblock %}
