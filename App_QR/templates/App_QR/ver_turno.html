{% extends 'App_QR/base.html' %}

{% block title %}Turno {{ turno.codigo }}{% endblock %}

{% block extra_css %}
<style>
    .turno-detalle {
        max-width: 800px;
        margin: 0 auto;
    }
    
    .qr-container {
        text-align: center;
        background: #f8f9fa;
        padding: 40px;
        border-radius: 15px;
        margin: 30px 0;
    }
    
    .qr-code {
        max-width: 300px;
        margin: 20px auto;
        padding: 20px;
        background: white;
        border-radius: 10px;
    }
    
    .qr-code img {
        width: 100%;
        height: auto;
    }
    
    .turno-numero {
        font-size: 3em;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 20px;
    }
    
    .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 30px 0;
    }
    
    .info-item {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
    }
    
    .info-label {
        font-weight: bold;
        color: #667eea;
        margin-bottom: 8px;
    }
    
    .info-value {
        font-size: 1.1em;
        color: #333;
    }
    
    .estado-badge {
        display: inline-block;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: bold;
        text-transform: uppercase;
        font-size: 0.9em;
    }
    
    .estado-pendiente {
        background: #fff3cd;
        color: #856404;
    }
    
    .estado-en_atencion {
        background: #ffc107;
        color: #fff;
    }
    
    .estado-atendido {
        background: #28a745;
        color: #fff;
    }
    
    .estado-cancelado {
        background: #dc3545;
        color: #fff;
    }
    
    .actions {
        display: flex;
        gap: 15px;
        margin-top: 30px;
        flex-wrap: wrap;
        justify-content: center;
    }
</style>
{% endblock %}

{% block content %}
<div class="turno-detalle">
    <div class="qr-container">
        <div class="turno-numero">TURNO {{ turno.codigo }}</div>
        <div class="estado-badge estado-{{ turno.estado }}">
            {{ turno.get_estado_display }}
        </div>
        
        <div class="qr-code">
            <img src="{{ qr_code }}" alt="C√≥digo QR Turno {{ turno.codigo }}">
        </div>
        
        <p>Escanea este c√≥digo QR para ver el estado del turno</p>
    </div>
    
    <div class="info-grid">
        <div class="info-item">
            <div class="info-label">üë§ Cliente</div>
            <div class="info-value">{{ turno.cliente_nombre }}</div>
        </div>
        
        {% if turno.cliente_email %}
        <div class="info-item">
            <div class="info-label">üìß Email</div>
            <div class="info-value">{{ turno.cliente_email }}</div>
        </div>
        {% endif %}
        
        {% if turno.cliente_telefono %}
        <div class="info-item">
            <div class="info-label">üì± Tel√©fono</div>
            <div class="info-value">{{ turno.cliente_telefono }}</div>
        </div>
        {% endif %}
        
        <div class="info-item">
            <div class="info-label">üîß Servicio</div>
            <div class="info-value">{{ turno.servicio }}</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">üïí Creado</div>
            <div class="info-value">{{ turno.fecha_creacion|date:"d/m/Y H:i" }}</div>
        </div>
        
        {% if turno.fecha_atencion %}
        <div class="info-item">
            <div class="info-label">‚è∞ Atenci√≥n</div>
            <div class="info-value">{{ turno.fecha_atencion|date:"d/m/Y H:i" }}</div>
        </div>
        {% endif %}
    </div>
    
    {% if turno.observaciones %}
    <div class="info-item">
        <div class="info-label">üìù Observaciones</div>
        <div class="info-value">{{ turno.observaciones }}</div>
    </div>
    {% endif %}
    
    <div class="actions">
        <a href="{% url 'descargar_qr' turno.uuid %}" class="btn btn-success">Descargar QR</a>
        
        {% if turno.estado == 'pendiente' %}
        <a href="{% url 'cambiar_estado' turno.uuid 'en_atencion' %}" class="btn">Marcar en Atenci√≥n</a>
        {% elif turno.estado == 'en_atencion' %}
        <a href="{% url 'cambiar_estado' turno.uuid 'atendido' %}" class="btn btn-success">Marcar como Atendido</a>
        {% endif %}
        
        {% if turno.estado != 'cancelado' and turno.estado != 'atendido' %}
        <a href="{% url 'cambiar_estado' turno.uuid 'cancelado' %}" class="btn btn-danger">Cancelar Turno</a>
        {% endif %}
        
        <a href="{% url 'home' %}" class="btn btn-secondary">Volver al Inicio</a>
    </div>
</div>
{% endblock %}
